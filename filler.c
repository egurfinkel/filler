/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   filler.c                                           :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: egurfink <marvin@42.fr>                    +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2017/04/15 17:23:42 by egurfink          #+#    #+#             */
/*   Updated: 2017/05/09 17:26:54 by egurfink         ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include <stdio.h>
#include "includes/libft.h"
#include "includes/get_next_line.h"
#include "includes/ft_printf.h"

#define FD 0

typedef struct		s_s
{
	char			player;
	char			enemy;
	int				brk;
	char			**map;
	int				map_x;
	int				map_y;
	char 			**piece;
	int 			piece_cord_x;
	int 			piece_cord_y;
	int 			piece_x;
	int 			piece_y;
	int 			find;
}					t_t;

void				_struct_init(t_t **s)
{
	(*s) = (t_t*)malloc(sizeof(t_t));
	(*s)->player = 'X';
	(*s)->enemy = 'O';
	(*s)->brk = 0;
	(*s)->map = NULL;
	(*s)->map_x = 0;
	(*s)->map_y = 0;
	(*s)->piece = NULL;
	(*s)->piece_cord_x = 0;
	(*s)->piece_cord_y = 0;
	(*s)->piece_x = -1;
	(*s)->piece_y = -1;
	(*s)->find = 1;
}

void		find_star(t_t *arr)
{
	int 	i;
	int 	j;

	i = 0;
	j = 0;
	while (1)
	{
		if (arr->piece[i][j] == '*')
			break ;
		if (arr->piece[i][j] == '.')
			j++;
		else
		{
			i++;
			j = 0;
		}
	}
	arr->piece_x = i;
	arr->piece_y = j;
}

void 		find_cords(t_t *foo)
{
	int		i;
	int		j;
	int 	find;

	i = 0;
	find = 0;
	while (i <= foo->piece_cord_x)
	{
		j = 0;
		while (j <= foo->piece_cord_y)
		{
			if (foo->map[i][j] == foo->player && foo->piece[i][j] == '*')
				foo->find = 2;
			j++;
		}
		i++;
	}
}

int			main()
{
	char *line;
	t_t *s;
	int i = 0;
	int x = 0;
	int y = 0;

	_struct_init(&s);
	line = (char *) malloc(sizeof(char) * 10000);
	get_next_line(FD, &line);
	if (line[10] == '1')
	{
		s->player = 'O';
		s->enemy = 'X';
	}
	get_next_line(FD, &line);
	i = 0;
	while (!ft_isdigit(line[i]))
		i++;
	s->map_x = 0;
	while (ft_isdigit(line[i]))
	{
		s->map_x += line[i] - '0';
		s->map_x *= 10;
		i++;
	}
	s->map_x /= 10;
//	ft_printf("%d\n", s->map_x);
	i++;																		//skip space between x && y
	while (ft_isdigit(line[i]))
	{
		s->map_y += line[i] - '0';
		s->map_y *= 10;
		i++;
	}
	s->map_y /= 10;
	s->map = (char **)malloc(sizeof(char *) * (s->map_x + 1));
	s->map[s->map_x] = NULL;
	i = 0;
	while (i < s->map_x)
	{
		s->map[i] = ft_strnew((size_t)(s->map_y + 1));
		i++;
	}
	get_next_line(FD, &line);
//	ft_printf("%s\n", line);
	i = 0;
	int l;
	int p;
	while (i < s->map_x)
	{
		get_next_line(FD, &line);
//		ft_printf("%s\n", line);
		l = 0;
		p = 4;
		while (line[p])
		{
			s->map[i][l] = line[p];
			l++;
			p++;
		}
		i++;
	}
//	i = 0;
//	while (s->map[i])
//	{
//		ft_printf("%s\n", s->map[i]);
//		i++;
//	}
	get_next_line(FD, &line);
	i = 0;
	while (line[i] && !ft_isdigit(line[i]))
		i++;
	while (line[i] && ft_isdigit(line[i]))
	{
		s->piece_cord_x += line[i] - '0';
		s->piece_cord_x *= 10;
		i++;
	}
	s->piece_cord_x /= 10;
	i++;																		//skip space between x && y
	while (line[i] && ft_isdigit(line[i]))
	{
		s->piece_cord_y += line[i] - '0';
		s->piece_cord_y *= 10;
		i++;
	}
	s->piece_cord_y /= 10;
//	ft_printf("%d, %d\n", s->piece_cord_x, s->piece_cord_y);
	i = 0;
	s->piece = (char **)malloc(sizeof(char *) * (s->piece_cord_x + 1));
	s->piece[s->piece_cord_x] = NULL;
	while (i < s->piece_cord_x)
	{
		l = 0;
		s->piece[i] = ft_strnew((size_t) (s->piece_cord_y + 1));
		get_next_line(FD, &line);
		while (line[l])
		{
			s->piece[i][l] = line[l];
			l++;
		}
		i++;
	}
//	find_star(&s);
//	ft_printf("%d\n", s->piece_x);
//	ft_printf("%d\n", s->piece_y);
	int j;

	j = 0;
	while (s->find)
	{
		i = 0;
		find_star(s);
		while (i++ < s->map_x)
		{
			j = 0;
			while (s->map[i][j++] < s->map_y)
				find_cords(s);
			if (s->find == 2)
			{
				ft_printf("%d %d", i, j);
				s->find = -1;
			}
		}
	}
//	i = 0;
//	while (s->piece[i])
//		ft_printf("%s\n", s->piece[i++]);

//	ft_printf("\n%c %c\n", s->player, s->enemy);
//	ft_printf("%d %d\n", s->map_y, s->map_x);
//	ft_printf("%d %d\n", s->piece_cord_y, s->piece_cord_x);
//	ft_printf("%c\n", s->piece[0][0]);
//	return (0);
}
/*

 ===
$$$ exec p1 : [./a.out]
Plateau 15 17:
    01234567890123456
000 .................
001 .................
002 .................
003 .................
004 .................
005 .................
006 .................
007 .................
008 ..OO.............
009 .................
010 .................
011 .................
012 .............xx..
013 .................
014 .................
Piece 1 3:
.**

$$$ exec p2 : [./a.out]
Plateau 100 99:
    012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678
000 ...................................................................................................
001 ...................................................................................................
002 ...................................................................................................
003 ...................................................................................................
004 ...................................................................................................
005 ...................................................................................................
006 ...................................................................................................
007 ...................................................................................................
008 ...................................................................................................
009 ...................................................................................................
010 ...................................................................................................
011 ...................................................................................................
012 ...................................................................................................
013 ...................................................................................................
014 ...................................................................................................
015 ...................................................................................................
016 ...................................................................................................
017 ...................................................................................................
018 ...................................................................................................
019 ...................................................................................................
020 ...................................................................................................
021 ...................................................................................................
022 ...................................................................................................
023 ...................................................................................................
024 ...................................................................................................
025 ...................................................................................................
026 ...................................................................................................
027 ...................................................................................................
028 ...................................................................................................
029 ..............................X....................................................................
030 ...................................................................................................
031 ...................................................................................................
032 ...................................................................................................
033 ...................................................................................................
034 ...................................................................................................
035 ...................................................................................................
036 ...................................................................................................
037 ...................................................................................................
038 ...................................................................................................
039 ...................................................................................................
040 ...................................................................................................
041 ...................................................................................................
042 ...................................................................................................
043 ...................................................................................................
044 ...................................................................................................
045 ...................................................................................................
046 ...................................................................................................
047 ...................................................................................................
048 ...................................................................................................
049 ...................................................................................................
050 ...................................................................................................
051 ...................................................................................................
052 ...................................................................................................
053 ...................................................................................................
054 ...................................................................................................
055 ...................................................................................................
056 ...................................................................................................
057 ...................................................................................................
058 ...................................................................................................
059 ...................................................................................................
060 ...................................................................................................
061 ...................................................................................................
062 ...................................................................................................
063 ...................................................................................................
064 ...................................................................................................
065 ...................................................................................................
066 ...................................................................................................
067 ......................................................................o............................
068 .....................................................................oo............................
069 ......................................................................o............................
070 ...................................................................................................
071 ...................................................................................................
072 ...................................................................................................
073 ...................................................................................................
074 ...................................................................................................
075 ...................................................................................................
076 ...................................................................................................
077 ...................................................................................................
078 ...................................................................................................
079 ...................................................................................................
080 ...................................................................................................
081 ...................................................................................................
082 ...................................................................................................
083 ...................................................................................................
084 ...................................................................................................
085 ...................................................................................................
086 ...................................................................................................
087 ...................................................................................................
088 ...................................................................................................
089 ...................................................................................................
090 ...................................................................................................
091 ...................................................................................................
092 ...................................................................................................
093 ...................................................................................................
094 ...................................................................................................
095 ...................................................................................................
096 ...................................................................................................
097 ...................................................................................................
098 ...................................................................................................
099 ...................................................................................................
Piece 19 1:
.
.
.
.
.
.
.
.
.
.
.
*
*
*
.
.
.
.
.
  $$$ exec p2 : [./a.out]
 Plateau 100 99:
    012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678
000 ...................................................................................................
001 ...................................................................................................
002 ...................................................................................................
003 ...................................................................................................
004 ...................................................................................................
005 ...................................................................................................
006 ...................................................................................................
007 ...................................................................................................
008 ...................................................................................................
009 ...................................................................................................
010 ...................................................................................................
011 ...................................................................................................
012 ...................................................................................................
013 ...................................................................................................
014 ...................................................................................................
015 ...................................................................................................
016 ...................................................................................................
017 ...................................................................................................
018 ...................................................................................................
019 ...................................................................................................
020 ...................................................................................................
021 ...................................................................................................
022 ...................................................................................................
023 ...................................................................................................
024 ...................................................................................................
025 ...................................................................................................
026 ...................................................................................................
027 ...................................................................................................
028 ...................................................................................................
029 ..............................X....................................................................
030 ...................................................................................................
031 ...................................................................................................
032 ...................................................................................................
033 ...................................................................................................
034 ...................................................................................................
035 ...................................................................................................
036 ...................................................................................................
037 ...................................................................................................
038 ...................................................................................................
039 ...................................................................................................
040 ...................................................................................................
041 ...................................................................................................
042 ...................................................................................................
043 ...................................................................................................
044 ...................................................................................................
045 ...................................................................................................
046 ...................................................................................................
047 ...................................................................................................
048 ...................................................................................................
049 ...................................................................................................
050 ...................................................................................................
051 ...................................................................................................
052 ...................................................................................................
053 ...................................................................................................
054 ...................................................................................................
055 ...................................................................................................
056 ...................................................................................................
057 ...................................................................................................
058 ...................................................................................................
059 ...................................................................................................
060 ...................................................................................................
061 ...................................................................................................
062 ...................................................................................................
063 ...................................................................................................
064 ...................................................................................................
065 ...................................................................................................
066 ...................................................................................................
067 ...................................................................................................
068 ....................................................................oo.............................
069 .....................................................................oo............................
070 ...................................................................................................
071 ...................................................................................................
072 ...................................................................................................
073 ...................................................................................................
074 ...................................................................................................
075 ...................................................................................................
076 ...................................................................................................
077 ...................................................................................................
078 ...................................................................................................
079 ...................................................................................................
080 ...................................................................................................
081 ...................................................................................................
082 ...................................................................................................
083 ...................................................................................................
084 ...................................................................................................
085 ...................................................................................................
086 ...................................................................................................
087 ...................................................................................................
088 ...................................................................................................
089 ...................................................................................................
090 ...................................................................................................
091 ...................................................................................................
092 ...................................................................................................
093 ...................................................................................................
094 ...................................................................................................
095 ...................................................................................................
096 ...................................................................................................
097 ...................................................................................................
098 ...................................................................................................
099 ...................................................................................................
Piece 1 4:
..**
 ++
$$$ exec p2 : [./a.out]
Plateau 24 40:
    0123456789012345678901234567890123456789
000 ........................................
001 ........................................
002 ........................................
003 ...o....................................
004 ...o....................................
005 ...o....................................
006 ........................................
007 ........................................
008 ........................................
009 ........................................
010 ........................................
011 ........................................
012 ........................................
013 ........................................
014 ........................................
015 ........................................
016 ........................................
017 ........................................
018 ........................................
019 ................................X.......
020 ........................................
021 ........................................
022 ........................................
023 ........................................
Piece 4 4:
....
...*
.*.*
.***
$$$ exec p2 : [./a.out]
Plateau 24 40:
    0123456789012345678901234567890123456789
000 ........................................
001 ........................................
002 ........................................
003 ...o....................................
004 ...o....................................
005 ...o....................................
006 ........................................
007 ........................................
008 ........................................
009 ........................................
010 ........................................
011 ........................................
012 ........................................
013 ........................................
014 ........................................
015 ........................................
016 ........................................
017 ........................................
018 ........................................
019 ................................X.......
020 ........................................
021 ........................................
022 ........................................
023 ........................................
Piece 4 4:
....
...*
.*.*
.***

 */